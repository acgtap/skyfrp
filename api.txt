HTTP服务器接口调用文档
========================

基础信息
--------
基础URL: https://mskapi.cnwbhw.com/
服务器地址: 43.242.193.146:8080
请求格式: form-data（表单数据）或 JSON（部分接口）
响应格式: JSON（统一格式）
字符编码: UTF-8

通用响应格式
------------
{
  "code": 0,      // 0表示成功，非0表示失败
  "msg": "消息",
  "timestamp": "时间戳",
  "data": {}      // 可选，返回的数据
}

错误代码说明
-----------
0: 成功
-1: 服务器错误或通用错误
-2: 临时密钥无效或过期
-3: 数据库查询失败
-4: 验证信息不存在或已过期
-7: 验证码已过期
-8: 用户被封禁
-10: 验证码错误

接口列表（共26个接口）
---------------------



5. 卡密验证接口
接口地址: /api/wyzz_kami_key
请求方法: POST
请求格式: form-data
请求参数:
  users_id: integer, 必填, 用户ID（整数）
  kami_data: string, 必填, 卡密数据
卡密类型:
  member: 会员卡密 - 返回会员到期时间
  amount: 余额卡密 - 返回充值金额
  traffic_users: 流量卡密 - 返回增加的流量

6. 更新用户全部数据接口
接口地址: /api/reboot_users_data
请求方法: POST
请求格式: form-data
请求参数:
  user_temp_key: string, 必填, 临时密钥

7. 获取FRP节点配置接口
接口地址: /api/get_frp_node_config
请求方法: POST
请求格式: form-data
请求参数:
  user_temp_key: string, 必填, 临时密钥
  user_tunnel: string, 必填, 隧道名称

8. 删除FRP隧道接口
接口地址: /api/delete_frp_tunnel
请求方法: POST
请求格式: form-data
请求参数:
  user_temp_key: string, 必填, 临时密钥
  tunnel_name: string, 必填, 隧道名称

9. 创建FRP隧道接口
接口地址: /api/create_frp_tunnel
请求方法: POST
请求格式: form-data
请求参数:
  user_temp_key: string, 必填, 临时密钥
  Tunnel_name: string, 必填, 隧道名称
  Local_ip: string, 必填, 本地IP地址
  Local_port: string, 必填, 本地端口
  node_ip: string, 必填, 节点IP地址
  use_agreement: string, 必填, 使用协议（tcp/http/https）
  return_port: string, 必填, 远程端口
  serverName: string, 可选, 服务器名称（HTTP/HTTPS协议时需要）
  secretKey: string, 可选, 密钥（HTTP/HTTPS协议时需要）

10. 获取用户隧道列表接口
接口地址: /api/get_frp_tunnel_list
请求方法: POST
请求格式: form-data
请求参数:
  user_temp_key: string, 必填, 临时密钥

11. 获取用户所有数据接口
接口地址: /api/get_users_all_data
请求方法: POST
请求格式: form-data
请求参数:
  user_temp_key: string, 必填, 临时密钥

12. 用户签到接口
接口地址: /api/users_sign_in
请求方法: POST
请求格式: form-data
请求参数:
  user_temp_key: string, 必填, 临时密钥
说明: 用户每日可签到一次，获得随机流量奖励

13. MSKPro模式接口
接口地址: /api/mskpro_mode
请求方法: POST
请求格式: form-data
请求参数:
  user_temp_key: string, 必填, 临时密钥
  mode: string, 必填, 模式类型

14. 获取QQ登录URL接口
接口地址: /api/qq_login_url
请求方法: GET
请求参数: 无
说明: 返回QQ登录的跳转URL，用户需要跳转到返回的login_url进行QQ授权登录

15. QQ登录回调接口
接口地址: /auth/qq-callback
请求方法: GET
请求参数:
  code: string, 必填, QQ返回的授权码
  state: string, 可选, 防止CSRF攻击的状态参数
  type: string, 可选, 登录类型，默认为qq
  redirect: string, 可选, 设置为1时重定向到前端页面
说明: 使用openid作为用户的唯一标识符（users_uid），新用户自动注册

16. 通用代理接口
接口地址: /api/proxy
请求方法: GET
请求参数:
  url: string, 必填, 目标URL地址
  其他参数: any, 可选, 其他任意参数，将传递给目标URL
说明: 仅支持白名单域名（*.cnwbhw.com）

17. 获取FRP节点列表接口
接口地址: /api/get_frp_nodes
请求方法: GET
请求参数:
  users_id: integer, 必填, 用户ID（整数）
  json: string, 可选, 设置为1时返回JSON格式，否则返回文本格式
  nocolor: string, 可选, 设置为1时禁用文本格式的颜色代码
说明: 支持JSON和文本两种输出格式，文本格式适合命令行工具使用

18. 获取商店商品列表接口
接口地址: /api/get_shop_list
请求方法: GET/POST
请求参数: 无

19. 余额购买商品接口
接口地址: /api/shop_purchase
请求方法: POST
请求格式: form-data
请求参数:
  user_temp_key: string, 必填, 临时密钥
  product_id: integer, 必填, 商品ID

20. 发送邮箱验证码接口
接口地址: /api/send_email_code
请求方法: GET
请求参数:
  email: string, 必填, 邮箱地址
  user_temp_key: string, 必填, 临时密钥
说明: 仅支持QQ邮箱和网易邮箱，验证码有效期为10分钟

21. 验证邮箱验证码接口
接口地址: /api/verify_email_code
请求方法: GET
请求参数:
  code: string, 必填, 验证码
  users_id: string, 可选, 用户ID（优先使用）
  users_uid: string, 可选, 用户UID（users_id未提供时使用）
说明: 验证码最多尝试5次，验证成功后验证码立即失效

22. 实名认证初始化接口
接口地址: /api/certification/init
请求方法: POST
请求格式: JSON
请求参数:
  user_temp_key: string, 必填, 临时密钥
  realname: string, 必填, 真实姓名
  idcard: string, 必填, 身份证号码（15或18位）
  cert_type: string, 可选, 认证类型：person/company，默认person

23. 查询认证状态接口
接口地址: /api/certification/status
请求方法: POST
请求格式: JSON
请求参数:
  user_temp_key: string, 必填, 临时密钥
  certify_id: string, 必填, 认证ID

24. 获取认证信息接口
接口地址: /api/certification/info
请求方法: POST
请求格式: JSON
请求参数:
  user_temp_key: string, 必填, 临时密钥

25. 隧道流量查询接口
接口地址: /api/traffic/query
请求方法: POST
请求格式: JSON
请求参数:
  user_temp_key: string, 必填, 临时密钥
  tunnel_name: string, 可选, 单个隧道名称（与tunnel_names二选一）
  tunnel_names: array, 可选, 多个隧道名称数组（与tunnel_name二选一）
  date_range: string, 可选, 时间范围：today(今天) 或 7days(最近7天)
说明: 不传隧道相关参数时，默认查询全部隧道

26. 健康检查接口
接口地址: /api/health
请求方法: GET
请求参数: 无

注意事项
--------
1. 所有POST接口（除特别说明外）均使用form-data格式提交数据
2. 实名认证相关接口使用JSON格式提交数据
3. 部分接口有IP白名单限制（如用户注册接口）
4. 所有接口都有频率限制，频繁请求可能会被暂时禁止
5. 临时密钥（temp_key）是用户身份验证的重要凭证，请妥善保管
6. QQ登录使用第三方服务，回调地址为 http://43.242.193.146:8080/auth/qq-callback
7. 新用户注册后自动获得5G用户流量（长期有效）和5G每月流量
8. 邮箱验证码存储在内存中，服务器重启后失效
9. 验证码有效期为10分钟，最多尝试5次
10. 通用代理接口仅支持白名单域名（*.cnwbhw.com）

文档版本: 2025-12-11
基于实际代码实现，包含26个接口
